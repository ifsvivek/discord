(function(l,m,p){"use strict";const f=[],{getCustomEmojiById:y}=m.findByStoreName("EmojiStore"),d=m.findByName("RowManager"),c=/https:\/\/cdn.discordapp.com\/emojis\/(\d+)\.\w+/;f.push(p.before("generate",d.prototype,function(a){let[o]=a;var r;if(o.rowType!==1)return;let e=o.message.content;if(!e?.length)return;const s=(r=e.match(c))===null||r===void 0?void 0:r.index;if(s===void 0)return;const t=e.slice(s).trim().split(`
`);if(!t.every(function(n){return n.match(c)}))return;for(e=e.slice(0,s);e.indexOf("  ")!==-1;)e=e.replace("  ",` ${t.shift()} `);e=e.trim(),t.length&&(e+=` ${t.join(" ")}`);const i=o.message.embeds;for(let n=0;n<i.length;n++){const u=i[n];u.type==="image"&&u.url.match(c)&&i.splice(n--,1)}o.message.content=e,o.__realmoji=!0})),f.push(p.after("generate",d.prototype,function(a,o){let[r]=a;if(r.rowType!==1||r.__realmoji!==!0)return;const{content:e}=o.message;if(!Array.isArray(e))return;const s=e.every(function(t){return t.type==="link"&&t.target.match(c)||t.type==="text"&&t.content===" "});for(let t=0;t<e.length;t++){const i=e[t];if(i.type!=="link")continue;const n=i.target.match(c);if(!n)continue;const u=`${n[0]}?size=128`,h=y(n[1]);e[t]={type:"customEmoji",id:n[1],alt:h?.name??"<realmoji>",src:u,frozenSrc:u.replace("gif","webp"),jumboable:s?!0:void 0}}}));const g=function(){return f.forEach(function(a){return a()})};return l.onUnload=g,l})({},vendetta.metro,vendetta.patcher);
