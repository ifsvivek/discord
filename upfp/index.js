(function(a,d,U,b,A,i,u){"use strict";const f=i.findByProps("getUserAvatarURL","getUserAvatarSource"),P=i.findByProps("getBadgeAsset"),S=i.findByStoreName("UserProfileStore"),m=i.findByStoreName("UserStore");let s;const l=async function(){try{s=await(await U.safeFetch(g,{cache:"no-store"})).json()}catch(t){d.logger.error(`Failed to fetch avatars!
${t.stack}`)}};async function w(){const t=new Array;if(await l(),!s||!a.enabled)return function(){};const L=setInterval(function(){return l()},1e3*60*60);t.push(function(){return clearInterval(L)}),t.push(u.after("getUserAvatarURL",f,function(e){let[{id:n}]=e;return s.avatars[n]})),t.push(u.after("getUserAvatarSource",f,function(e,n){let[{id:r}]=e;return s.avatars[r]?{uri:s.avatars[r]}:n}));const h=Symbol("empty"),o="usrpfp-";return t.push(u.after("getUserProfile",S,function(e,n){let[r]=e;var c;const p=(c=m.getUser(r))===null||c===void 0?void 0:c.username,y=s.badges[r]??s.badges[p];return n&&{...n,badges:[y?{id:"usrpfp-custom",description:`${p}'s custom badge`,icon:o+y}:h,...n.badges].filter(function(R){return R!==h})}})),t.push(u.after("getBadgeAsset",P,function(e,n){let[r]=e;return r.startsWith(o)?r.slice(o.length):n})),function(){return t.forEach(function(e){return e()})}}const g="https://ifsvivek.github.io/discordpfp/pfp.json";a.enabled=!1;let v;var B={onLoad:async function(){a.enabled=!0;try{v=await w()}catch(t){d.logger.error(`Errored while patching!
${t.stack}`),b.stopPlugin(A.id)}},onUnload:function(){a.enabled=!1,v?.()}};return a.dataURL=g,a.default=B,Object.defineProperty(a,"__esModule",{value:!0}),a})({},vendetta,vendetta.utils,vendetta.plugins,vendetta.plugin,vendetta.metro,vendetta.patcher);
