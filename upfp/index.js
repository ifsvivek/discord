(function(a,c,y,U,b,i,u){"use strict";const d=i.findByProps("getUserAvatarURL","getUserAvatarSource"),A=i.findByProps("getBadgeAsset"),S=i.findByStoreName("UserProfileStore"),w=i.findByStoreName("UserStore");let s;const f=async function(){try{s=await(await y.safeFetch(l,{cache:"no-store"})).json()}catch(t){c.logger.error(`Failed to fetch avatars!
${t.stack}`)}};async function B(){const t=new Array;if(await f(),!s||!a.enabled)return function(){};const m=setInterval(function(){return f()},1e3*60*60);t.push(function(){return clearInterval(m)}),t.push(u.after("getUserAvatarURL",d,function(e){let[{id:n}]=e;return s.avatars[n]})),t.push(u.after("getUserAvatarSource",d,function(e,n){let[{id:r}]=e;return s.avatars[r]?{uri:s.avatars[r]}:n}));const v=Symbol("empty"),o="usrpfp-";return t.push(u.after("getUserProfile",S,function(e,n){let[r]=e;const h=w.getUser(r)?.username,p=s.badges[r]??s.badges[h];return n&&{...n,badges:[p?{id:"usrpfp-custom",description:`${h}'s custom badge`,icon:o+p}:v,...n.badges].filter(function(L){return L!==v})}})),t.push(u.after("getBadgeAsset",A,function(e,n){let[r]=e;return r.startsWith(o)?r.slice(o.length):n})),function(){return t.forEach(function(e){return e()})}}const l="https://ifsvivek.github.io/discordpfp/pfp.json";a.enabled=!1;let g;var P={onLoad:async function(){a.enabled=!0;try{g=await B()}catch(t){c.logger.error(`Errored while patching!
${t.stack}`),U.stopPlugin(b.id)}},onUnload:function(){a.enabled=!1,g?.()}};return a.dataURL=l,a.default=P,Object.defineProperty(a,"__esModule",{value:!0}),a})({},vendetta,vendetta.utils,vendetta.plugins,vendetta.plugin,vendetta.metro,vendetta.patcher);
