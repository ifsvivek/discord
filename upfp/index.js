(function(n,l,R,L,d,h,_,g,u,A){"use strict";const v=g.findByProps("getUserAvatarURL","getUserAvatarSource"),S=g.findByStoreName("UserStore");let o;const U=async function(){try{o=await(await A.safeFetch(`${y}?_=${n.hash}`,{cache:"no-store"})).json()}catch(t){const r=i.format("log.fetch_error",{});console.error(`[UsrPFP] ${r}`),l.logger.error(`${r}
${t.stack}`),h.showToast(i.format("toast.fetch_error",{}),d.getAssetIDByName("Small"))}},m=function(t,r){if(!o.avatars[t])return;const a=o.avatars[t];if(r&&p(a)==="gif")return w(a);const e=new URL(a);return e.searchParams.append("_",n.hash),e.toString()},p=function(t){return new URL(t).pathname.split(".").slice(-1)[0]};async function P(){const t=new Array;if(await U(),!o||!n.enabled)return function(){};const r=setInterval(function(){return U()},1e3*60*60);return t.push(function(){return clearInterval(r)}),t.push(u.after("getUser",S,function(a,e){let[s]=a;if((o.avatars[s]&&p(o.avatars[s]))==="gif"&&e){const c=e.avatar??"0";e.avatar=c.startsWith("a_")?c:`a_${c}`}})),t.push(u.after("getUserAvatarURL",v,function(a){let[{id:e},s]=a;return m(e,!s)})),t.push(u.after("getUserAvatarSource",v,function(a,e){let[{id:s},c]=a;const f=m(s,!c);if(f)return f?{uri:f}:e})),function(){return t.forEach(function(a){return a()})}}const y="https://ifsvivek.github.io/discordpfp/pfp.json",w=function(t){return`https://static-gif.nexpid.workers.dev/convert.gif?url=${encodeURIComponent(t)}&_=${n.hash}`};n.enabled=!1,n.hash=void 0;const i=new _.Lang("usrpfp");let $;var b={onLoad:async function(){n.hash=Array.from(crypto.getRandomValues(new Uint8Array(20))).map(function(t){return t.toString(16).padStart(2,"0")}).join(""),n.enabled=!0;try{$=await P()}catch(t){const r=i.format("log.patch_error",{});console.error(`[UsrPFP] ${r}`),l.logger.error(`${r}
${t.stack}`),h.showToast(i.format("toast.patch_error",{}),d.getAssetIDByName("Small")),L.stopPlugin(R.id)}},onUnload:function(){n.enabled=!1,$?.(),i.unload()}};return n.dataURL=y,n.default=b,n.lang=i,n.staticGifURL=w,Object.defineProperty(n,"__esModule",{value:!0}),n})({},vendetta,vendetta.plugin,vendetta.plugins,vendetta.ui.assets,vendetta.ui.toasts,lang$1,vendetta.metro,vendetta.patcher,vendetta.utils);
